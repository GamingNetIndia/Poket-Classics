:root {
    --board-bg: #008000; --cell-border: #004d00; --piece-black: #111; --piece-white: #f0f0f0; --highlight-color: rgba(255, 255, 0, 0.5);
    --menu-bg: rgba(0, 0, 0, 0.85); --text-light: #f0f0f0; --button-bg: #4CAF50; --button-hover-bg: #45a049; --app-bg: #333;
}
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; justify-content: center; align-items: center;
    min-height: 100vh; margin: 0; background-color: var(--app-bg); color: var(--text-light); overflow: hidden; padding: 10px; box-sizing: border-box;
}

/* --- CORRECTED: Main Game Screen Layout --- */
#game-screen {
    display: flex; /* <-- THIS WAS THE ERROR. Changed from 'none' to 'flex'. */
    flex-direction: column;
    align-items: center;
    gap: 15px;
    width: 100%;
    max-width: 900px;
}
#game-screen.hidden {
    display: none !important;
}

/* Info/Status Panels */
.game-info-panel { display: flex; flex-direction: column; gap: 10px; width: 100%; max-width: 500px; background-color: rgba(0,0,0,0.2); padding: 10px; border-radius: 10px; }
.game-info { display: flex; justify-content: space-around; align-items: center; width: 100%; font-size: clamp(1rem, 4vw, 1.2rem); }
.score { display: flex; align-items: center; gap: 10px; font-weight: bold; font-size: 1.2em; }
.score .piece { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.5); }
#player-turn { padding: 5px 15px; border-radius: 20px; background-color: #4a4a4a; transition: background-color 0.3s; }
.status-bar { display: flex; justify-content: space-between; align-items: center; width: 100%; min-height: 30px; }
#status-message { flex-grow: 1; text-align: center; font-style: italic; color: #ffc107; }
#settings-btn { font-size: 1.5rem; cursor: pointer; user-select: none; padding: 0 10px; }

/* Responsive Board */
#board-container { width: 90vw; height: 90vw; max-width: 500px; max-height: 500px; aspect-ratio: 1 / 1; display: grid; grid-template-columns: repeat(8, 1fr); grid-template-rows: repeat(8, 1fr); background-color: var(--board-bg); border: 5px solid var(--cell-border); box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
.cell { border: 1px solid var(--cell-border); display: flex; justify-content: center; align-items: center; position: relative; }
.piece { width: 85%; height: 85%; border-radius: 50%; transition: transform 0.6s, background-color 0.5s; transform-style: preserve-3d; }
.piece.black { background-color: var(--piece-black); box-shadow: inset 0 3px 5px rgba(0,0,0,0.5); }
.piece.white { background-color: var(--piece-white); box-shadow: inset 0 3px 5px rgba(255,255,255,0.5); }
.valid-move-highlighter { position: absolute; width: 40%; height: 40%; background-color: var(--highlight-color); border-radius: 50%; cursor: pointer; transition: transform 0.2s ease-out, background-color 0.2s; }
.valid-move-highlighter:hover { transform: scale(1.15); background-color: rgba(255, 255, 0, 0.7); }

/* Menus & Popups */
.overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--menu-bg); display: flex; justify-content: center; align-items: center; z-index: 100; flex-direction: column; text-align: center; transition: opacity 0.3s; }
.menu { background-color: #2c2c2c; padding: 20px 40px; border-radius: 10px; box-shadow: 0 0 30px rgba(0,0,0,0.5); width: 90%; max-width: 400px; }
.menu h1, .menu h2 { margin-top: 0; }
.menu button { display: block; width: 100%; padding: 15px; margin: 10px 0; font-size: 1.1em; cursor: pointer; border: none; border-radius: 5px; background-color: var(--button-bg); color: white; transition: background-color 0.3s; }
.menu button:hover { background-color: var(--button-hover-bg); }
.hidden { display: none !important; }
.invisible { opacity: 0; pointer-events: none; }
.settings-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; gap: 20px; }
.settings-file-input { margin-top: 5px; margin-bottom: 20px; }
.toggle-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
.toggle-switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 26px; }
.slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
input:checked + .slider { background-color: var(--button-bg); }
input:checked + .slider:before { transform: translateX(24px); }
input[type="file"] { color: var(--text-light); }
#win-particles-canvas { position: absolute; top: 0; left: 0; z-index: 101; pointer-events: none; }
#win-popup-content { position: relative; z-index: 102; }
#win-result { font-size: clamp(2rem, 8vw, 3rem); margin-bottom: 10px; }
#win-score { font-size: clamp(1rem, 5vw, 1.5rem); margin-bottom: 30px; }

/* Media Query for Larger Screens */
@media (min-width: 768px) {
    #game-screen { flex-direction: row; align-items: center; justify-content: center; }
    .game-info-panel { order: -1; width: 250px; height: 90vmin; max-height: 500px; justify-content: space-between; }
    .game-info { flex-direction: column; gap: 20px; }
    #back-to-menu-game-btn { margin-top: 0; }
}
